import { CodePreview } from "$/components/CodePreview"
import { useSWRTypePreview } from "$/components/previews/useSWR.type.preview"
import { swrResponseTypePreview } from "$/components/previews/SWRResponse.type.preview"
import { ExternalLink } from "$/components/atoms/ExternalLink"
import { DocsSectionHeader } from "$/components/DocsSectionHeader"
import { HighlightOnLoad } from "$/components/HighlightOnLoad"
import { CopyInnerText } from "$/components/CopyInnerText"
import { siteCodeLang } from "$/state/siteCodeLang"
import BasicExample from "./basicExample.md"
import BasicExampleTS from "./basicExample.ts.md"
import MutationExample from "./mutationExample.md"
import MutationExampleTS from "./mutationExample.ts.md"

# SWR

<CodePreview data={useSWRTypePreview} /> is a hook for data fetching that provides 
caching, revalidation, and mutation capabilities. It's designed to make data fetching 
simple and efficient by automatically handling loading states, error handling, and 
cache management.

Inspired by <ExternalLink href="https://swr.vercel.app/" >Vercel's SWR</ExternalLink>, 
it follows the stale-while-revalidate pattern, serving cached data while fetching 
fresh data in the background.

<HighlightOnLoad id="basic-usage">
  <DocsSectionHeader href="#basic-usage">
    Basic Usage
  </DocsSectionHeader>

  <CodePreview data={useSWRTypePreview} /> takes a key and a fetcher function, 
  and returns an <CodePreview data={swrResponseTypePreview} /> object containing:

  - **data**: The fetched data (null if not loaded)
  - **loading**: Boolean indicating if the initial request is pending
  - **error**: Error object if the request failed
  - **mutate**: Function to trigger mutations and update the cache
  - **isMutating**: Signal indicating if a mutation is in progress
  - **isValidating**: Signal indicating if revalidation is happening

  <CopyInnerText>
    {siteCodeLang.value === "js" ? <BasicExample /> : <BasicExampleTS />}
  </CopyInnerText>
</HighlightOnLoad>

<HighlightOnLoad id="mutations">
  <DocsSectionHeader href="#mutations">
    Mutations
  </DocsSectionHeader>

  The `mutate` function allows you to update data and trigger revalidation. 
  It accepts a function that returns a Promise, and the cache will be updated 
  with the resolved value.

  <CopyInnerText>
    {siteCodeLang.value === "js" ? <MutationExample /> : <MutationExampleTS />}
  </CopyInnerText>
</HighlightOnLoad>

<HighlightOnLoad id="caching">
  <DocsSectionHeader href="#caching">
    Caching
  </DocsSectionHeader>

  Multiple components using the same key will share the same data and only 
  trigger one network request. The cache is automatically managed and data 
  is revalidated when components mount or when the window regains focus.
</HighlightOnLoad>

### Related
<ul>
  <li><a href="/docs/hooks/useAsync">useAsync</a></li>
  <li><a href="/docs/api/signal">Signal</a></li>
</ul>
